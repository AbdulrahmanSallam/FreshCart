"use strict";(self.webpackChunkfreshcart=self.webpackChunkfreshcart||[]).push([[125],{9125:(G,_,l)=>{l.r(_),l.d(_,{SettingComponent:()=>D});var a=l(6814),r=l(95),t=l(4769),d=l(9862);let u=(()=>{class n{constructor(e){this._HttpClient=e,this.baseUrl="https://ecommerce.routemisr.com/api/v1/users/"}getUserData(e){return this._HttpClient.get(this.baseUrl+e)}editAccount(e){return this._HttpClient.put(this.baseUrl+"updateMe/",e)}newPassword(e){return this._HttpClient.put(this.baseUrl+"changeMyPassword/",e)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(d.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var p=l(9410),m=l(1120);function g(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Name is required"),t.qZA())}function f(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," at least 3 characters"),t.qZA())}function v(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," at most 20 characters"),t.qZA())}function x(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,g,3,0,"p",24),t.YNc(2,f,3,0,"p",24),t.YNc(3,v,3,0,"p",24),t.qZA()),2&n){const e=t.oxw(3);let o,i,c;t.xp6(1),t.Q6J("ngIf",null==(o=e.editAccountForm.get("name"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editAccountForm.get("name"))?null:i.getError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(c=e.editAccountForm.get("name"))?null:c.getError("maxlength"))}}function h(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Email is required"),t.qZA())}function Z(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Invalid email"),t.qZA())}function w(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,h,3,0,"p",24),t.YNc(2,Z,3,0,"p",24),t.qZA()),2&n){const e=t.oxw(3);let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=e.editAccountForm.get("email"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editAccountForm.get("email"))?null:i.getError("email"))}}function A(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," phone is required"),t.qZA())}function T(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Invalid phone"),t.qZA())}function q(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,A,3,0,"p",24),t.YNc(2,T,3,0,"p",24),t.qZA()),2&n){const e=t.oxw(3);let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=e.editAccountForm.get("phone"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editAccountForm.get("phone"))?null:i.getError("pattern"))}}function I(n,s){1&n&&t._UZ(0,"i",27)}function S(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"div")(2,"h2",9),t._uU(3,"edit account"),t.qZA(),t.TgZ(4,"form",10),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.editAccount())}),t.TgZ(5,"div",11)(6,"div",12)(7,"label",13),t._uU(8,"Name :"),t.qZA(),t.YNc(9,x,4,3,"div",14),t.qZA(),t._UZ(10,"input",15),t.qZA(),t.TgZ(11,"div",11)(12,"div",12)(13,"label",16),t._uU(14,"Email :"),t.qZA(),t.YNc(15,w,3,2,"div",14),t.qZA(),t._UZ(16,"input",17),t.qZA(),t.TgZ(17,"div",11)(18,"div",12)(19,"label",18),t._uU(20,"Phone :"),t.qZA(),t.YNc(21,q,3,2,"div",14),t.qZA(),t._UZ(22,"input",19),t.qZA(),t.TgZ(23,"div",20)(24,"button",21),t.YNc(25,I,1,0,"i",22),t._uU(26," Submit"),t.qZA()()()()()}if(2&n){const e=t.oxw(2);let o,i,c;t.xp6(4),t.Q6J("formGroup",e.editAccountForm),t.xp6(5),t.Q6J("ngIf",(null==(o=e.editAccountForm.get("name"))?null:o.errors)&&(null==(o=e.editAccountForm.get("name"))?null:o.touched)),t.xp6(1),t.Q6J("placeholder",e.userData.name),t.xp6(5),t.Q6J("ngIf",(null==(i=e.editAccountForm.get("email"))?null:i.errors)&&(null==(i=e.editAccountForm.get("email"))?null:i.touched)),t.xp6(1),t.Q6J("placeholder",e.userData.email),t.xp6(5),t.Q6J("ngIf",(null==(c=e.editAccountForm.get("phone"))?null:c.errors)&&(null==(c=e.editAccountForm.get("phone"))?null:c.touched)),t.xp6(1),t.Q6J("placeholder",e.userData.phone),t.xp6(2),t.Q6J("disabled",e.editAccountForm.invalid),t.xp6(1),t.Q6J("ngIf",e.isLoading)}}function U(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Current password is required"),t.qZA())}function C(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Incorrect password"),t.qZA())}function P(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,U,3,0,"p",24),t.YNc(2,C,3,0,"p",24),t.qZA()),2&n){const e=t.oxw(3);let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=e.editPasswordForm.get("currentPassword"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editPasswordForm.get("currentPassword"))?null:i.getError("pattern"))}}function F(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Password is required"),t.qZA())}function N(n,s){1&n&&(t.TgZ(0,"p",25),t._UZ(1,"i",26),t._uU(2," Start with capital letter, (A-Z or a-z) and numbers(0-9), 6 to 10 Characters"),t.qZA())}function J(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,F,3,0,"p",24),t.YNc(2,N,3,0,"p",24),t.qZA()),2&n){const e=t.oxw(3);let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=e.editPasswordForm.get("password"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editPasswordForm.get("password"))?null:i.getError("pattern"))}}function b(n,s){1&n&&(t.TgZ(0,"p",37),t._UZ(1,"i",26),t._uU(2," Repassword is required"),t.qZA())}function Q(n,s){1&n&&(t.TgZ(0,"p",37),t._UZ(1,"i",26),t._uU(2," Not equal to Password"),t.qZA())}function Y(n,s){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,b,3,0,"p",36),t.YNc(2,Q,3,0,"p",36),t.qZA()),2&n){const e=t.oxw(3);let o,i;t.xp6(1),t.Q6J("ngIf",null==(o=e.editPasswordForm.get("rePassword"))?null:o.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=e.editPasswordForm.get("rePassword"))?null:i.getError("misMatch"))}}function E(n,s){if(1&n&&(t.TgZ(0,"p",38),t._uU(1),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Oqu(e.msgErr)}}function k(n,s){1&n&&t._UZ(0,"i",27)}function y(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"div")(2,"h2",9),t._uU(3,"edit password"),t.qZA(),t.TgZ(4,"form",10),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.editPassword())}),t.TgZ(5,"div",11)(6,"div",12)(7,"label",28),t._uU(8,"Current password :"),t.qZA(),t.YNc(9,P,3,2,"div",14),t.qZA(),t._UZ(10,"input",29),t.qZA(),t.TgZ(11,"div",11)(12,"div",12)(13,"label",30),t._uU(14,"Password :"),t.qZA(),t.YNc(15,J,3,2,"div",14),t.qZA(),t._UZ(16,"input",31),t.qZA(),t.TgZ(17,"div",11)(18,"div",12)(19,"label",32),t._uU(20,"rePassword :"),t.qZA(),t.YNc(21,Y,3,2,"div",33),t.qZA(),t._UZ(22,"input",34),t.qZA(),t.TgZ(23,"div",20),t.YNc(24,E,2,1,"p",35),t.TgZ(25,"button",21),t.YNc(26,k,1,0,"i",22),t._uU(27," Submit"),t.qZA()()()()()}if(2&n){const e=t.oxw(2);let o,i,c;t.xp6(4),t.Q6J("formGroup",e.editPasswordForm),t.xp6(5),t.Q6J("ngIf",(null==(o=e.editPasswordForm.get("currentPassword"))?null:o.errors)&&(null==(o=e.editPasswordForm.get("currentPassword"))?null:o.touched)),t.xp6(6),t.Q6J("ngIf",(null==(i=e.editPasswordForm.get("password"))?null:i.errors)&&(null==(i=e.editPasswordForm.get("password"))?null:i.touched)),t.xp6(6),t.Q6J("ngIf",(null==(c=e.editPasswordForm.get("rePassword"))?null:c.errors)&&(null==(c=e.editPasswordForm.get("rePassword"))?null:c.touched)),t.xp6(3),t.Q6J("ngIf",e.msgErr),t.xp6(1),t.Q6J("disabled",e.editPasswordForm.invalid),t.xp6(1),t.Q6J("ngIf",e.isLoading)}}function L(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openSection1())}),t._uU(6,"Edit account"),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openSection2())}),t._uU(8,"Edit password"),t.qZA()()(),t.YNc(9,S,27,9,"div",7),t.YNc(10,y,28,7,"div",7),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(9),t.Q6J("ngIf",e.section1),t.xp6(1),t.Q6J("ngIf",e.section2)}}let D=(()=>{class n{constructor(e,o,i){this._SettingService=e,this._AuthService=o,this._Router=i,this.userData={},this.msgErr="",this.isLoading=!1,this.section1=!0,this.section2=!1,this.editAccountForm=new r.cw({name:new r.NI("",[r.kI.required,r.kI.minLength(3),r.kI.maxLength(12)]),email:new r.NI("",[r.kI.required,r.kI.email]),phone:new r.NI("",[r.kI.required,r.kI.pattern(/^01[0125][0-9]{8}$/)])}),this.editPasswordForm=new r.cw({currentPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^[A-Z][\w]{6,9}$/)]),password:new r.NI("",[r.kI.required,r.kI.pattern(/^[A-Z][\w]{6,9}$/)]),rePassword:new r.NI("")},{validators:[this.confirmRepassword]})}ngOnInit(){this._AuthService.getUserInfo(),this._SettingService.getUserData(this._AuthService.userInfo.id).subscribe({next:e=>{this.userData=e.data},error:e=>{console.log(e)}})}editAccount(){this.isLoading=!0,this.editAccountForm.valid?this._SettingService.editAccount(this.editAccountForm.value).subscribe({next:e=>{this.isLoading=!1,"success"==e.message&&this._Router.navigate(["/login"])},error:e=>{this.isLoading=!1,this.msgErr=e.error.message,console.log(e)}}):(this.isLoading=!1,this.editAccountForm.markAllAsTouched())}confirmRepassword(e){const o=e.get("password"),i=e.get("rePassword");""==i?.value?i?.setErrors({required:!0}):i?.value!=o?.value&&i?.setErrors({misMatch:!0})}editPassword(){this.isLoading=!0,this.editPasswordForm.valid?this._SettingService.newPassword(this.editPasswordForm.value).subscribe({next:e=>{this.isLoading=!1,"success"==e.message&&this._Router.navigate(["/login"])},error:e=>{this.isLoading=!1,this.msgErr=e.error.message,console.log(e)}}):(this.isLoading=!1,this.editPasswordForm.markAllAsTouched())}openSection1(){this.section2=!1,this.section1=!0,this.msgErr=""}openSection2(){this.section2=!0,this.section1=!1,this.msgErr=""}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(u),t.Y36(p.e),t.Y36(m.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-setting"]],standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[["class","middle-page",4,"ngIf"],[1,"middle-page"],[1,"w-100","mx-4"],[1,"row","g-3","p-4","flex-column-reverse","flex-lg-row","bg-main-light","align-items-center","rounded"],[1,"col-lg-2"],[1,"gap-2","d-flex","justify-content-center","align-items-center","flex-row","flex-lg-column"],[1,"main-btn","d-block",3,"click"],["class","col-lg-10",4,"ngIf"],[1,"col-lg-10"],[1,"head"],[3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"d-flex","justify-content-between","align-items-center"],["for","name",1,"text-main"],["class","small",4,"ngIf"],["type","text","id","name","formControlName","name",1,"form-control",3,"placeholder"],["for","email",1,"text-main"],["type","text","id","email","formControlName","email",1,"form-control",3,"placeholder"],["for","phone",1,"text-main"],["type","text","id","phone","formControlName","phone",1,"form-control",3,"placeholder"],[1,"my-3","d-flex","justify-content-between","align-items-center"],[1,"main-btn","d-block","ms-auto",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"small"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"fas","fa-warning"],[1,"fas","fa-spinner","fa-spin"],["for","currentPassword",1,"text-main"],["type","password","id","currentPassword","formControlName","currentPassword",1,"form-control"],["for","password",1,"text-main"],["type","password","id","password","formControlName","password",1,"form-control"],["for","rePassword",1,"text-main"],[4,"ngIf"],["type","password","id","rePassword","formControlName","rePassword",1,"form-control"],["class","text-danger flex-grow-1",4,"ngIf"],["class","text-danger small",4,"ngIf"],[1,"text-danger","small"],[1,"text-danger","flex-grow-1"]],template:function(o,i){1&o&&t.YNc(0,L,11,2,"section",0),2&o&&t.Q6J("ngIf",i.userData.name)},dependencies:[a.ez,a.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return n})()}}]);